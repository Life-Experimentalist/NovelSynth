(()=>{"use strict";class t{constructor(){this.initializeElements(),this.setupEventListeners(),this.loadCurrentTab()}initializeElements(){this.elements={enhanceBtn:document.getElementById("enhance-btn"),summarizeBtn:document.getElementById("summarize-btn"),toggleBtn:document.getElementById("toggle-btn"),statusDiv:document.getElementById("status"),settingsBtn:document.getElementById("settings-btn"),storageInfo:document.getElementById("storage-info")}}setupEventListeners(){this.elements.enhanceBtn?.addEventListener("click",(()=>{this.enhanceContent()})),this.elements.summarizeBtn?.addEventListener("click",(()=>{this.summarizeContent()})),this.elements.toggleBtn?.addEventListener("click",(()=>{this.toggleContent()})),this.elements.settingsBtn?.addEventListener("click",(()=>{this.openSettings()})),this.loadStorageInfo()}async loadCurrentTab(){try{const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});this.currentTab=t,await this.updateStatus()}catch(t){console.error("Failed to load current tab:",t)}}async updateStatus(){if(this.currentTab?.id)try{const t=await chrome.tabs.sendMessage(this.currentTab.id,{action:"getContentStatus"});t?.hasEnhanced?(this.showStatus("Content enhanced âœ¨","success"),this.elements.toggleBtn.style.display="block"):t?.isProcessing?this.showStatus("Processing...","processing"):this.showStatus("Ready to enhance","ready")}catch(t){this.showStatus("Page not supported","error"),this.elements.enhanceBtn.disabled=!0,this.elements.summarizeBtn.disabled=!0}}async enhanceContent(){if(this.currentTab?.id)try{this.showStatus("Enhancing content...","processing"),this.elements.enhanceBtn.disabled=!0,await chrome.tabs.sendMessage(this.currentTab.id,{action:"enhanceContent",options:{}}),setTimeout((()=>{this.updateStatus(),this.elements.enhanceBtn.disabled=!1}),2e3)}catch(t){this.showStatus("Enhancement failed","error"),this.elements.enhanceBtn.disabled=!1}}async summarizeContent(){if(this.currentTab?.id)try{this.showStatus("Generating summary...","processing"),this.elements.summarizeBtn.disabled=!0,await chrome.tabs.sendMessage(this.currentTab.id,{action:"summarizeContent",options:{}}),setTimeout((()=>{this.updateStatus(),this.elements.summarizeBtn.disabled=!1}),2e3)}catch(t){this.showStatus("Summary failed","error"),this.elements.summarizeBtn.disabled=!1}}async toggleContent(){if(this.currentTab?.id)try{await chrome.tabs.sendMessage(this.currentTab.id,{action:"toggleContent"}),this.showStatus("Content toggled","success")}catch(t){this.showStatus("Toggle failed","error")}}showStatus(t,e){this.elements.statusDiv&&(this.elements.statusDiv.textContent=t,this.elements.statusDiv.className=`status ${e}`)}async loadStorageInfo(){try{const t=await chrome.runtime.sendMessage({type:"GET_STORAGE_STATS"});if(t?.success&&this.elements.storageInfo){const e=t.data;this.elements.storageInfo.textContent=`Stored: ${e.totalItems} items (${this.formatBytes(e.totalSize)})`}}catch(t){console.error("Failed to load storage info:",t)}}formatBytes(t){if(0===t)return"0 B";const e=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,e)).toFixed(2))+" "+["B","KB","MB","GB"][e]}openSettings(){chrome.runtime.openOptionsPage()}}document.addEventListener("DOMContentLoaded",(()=>{new t}))})();